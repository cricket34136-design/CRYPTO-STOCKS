<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INVITEGAIN | Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        :root {
            --primary: #7b2ff7;
            --primary-dark: #5e1ed2;
            --secondary: #00d4ff;
            --success: #00ff88;
            --danger: #ff5555;
            --warning: #ffaa00;
            --dark: #05060a;
            --darker: #030407;
            --light: #f8fafc;
            --gray: #94a3b8;
            --glass: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(123, 47, 247, 0.2);
            --gradient: linear-gradient(135deg, var(--primary), var(--secondary));
        }

        body {
            background: linear-gradient(135deg, var(--dark) 0%, #070b2a 50%, #12072a 100%);
            color: var(--light);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
            padding-bottom: 80px;
        }

        .bg-blob {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.15;
            z-index: 0;
        }

        .blob-1 {
            width: 400px;
            height: 400px;
            background: var(--primary);
            top: -150px;
            left: -150px;
            animation: float 20s infinite ease-in-out;
        }

        .blob-2 {
            width: 300px;
            height: 300px;
            background: var(--secondary);
            bottom: -120px;
            right: -120px;
            animation: float 25s infinite ease-in-out reverse;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            50% { transform: translate(30px, -30px) scale(1.1); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(123, 47, 247, 0.3); }
            50% { box-shadow: 0 0 40px rgba(123, 47, 247, 0.6); }
        }

        /* Toast System */
        .toast-container {
            position: fixed;
            top: 70px;
            left: 0;
            right: 0;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            padding: 0 20px;
            pointer-events: none;
        }

        .toast {
            background: rgba(10, 10, 26, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 16px 20px;
            width: 100%;
            max-width: 400px;
            display: flex;
            align-items: center;
            gap: 15px;
            animation: slideIn 0.4s ease-out;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.3);
            pointer-events: auto;
        }

        .toast.success {
            border-left: 4px solid var(--success);
        }

        .toast.error {
            border-left: 4px solid var(--danger);
        }

        .toast.info {
            border-left: 4px solid var(--primary);
        }

        .toast i {
            font-size: 20px;
        }

        .toast.success i {
            color: var(--success);
        }

        .toast.error i {
            color: var(--danger);
        }

        .toast.info i {
            color: var(--primary);
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 700;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .toast-message {
            font-size: 13px;
            color: var(--gray);
        }

        .toast-close {
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            font-size: 16px;
            padding: 5px;
            transition: color 0.3s ease;
        }

        .toast-close:hover {
            color: var(--light);
        }

        /* Top Navigation */
        .top-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(10, 10, 26, 0.95);
            backdrop-filter: blur(25px);
            border-bottom: 1px solid var(--glass-border);
            padding: 18px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .logo {
            font-size: 20px;
            font-weight: 900;
            background: var(--gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            letter-spacing: 1px;
        }

        .page-title {
            font-size: 17px;
            font-weight: 700;
            color: var(--light);
        }

        .nav-icons {
            display: flex;
            gap: 20px;
        }

        .nav-icon {
            background: none;
            border: none;
            color: var(--gray);
            font-size: 20px;
            cursor: pointer;
            padding: 8px;
            border-radius: 10px;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-icon:hover {
            color: var(--primary);
            background: rgba(123, 47, 247, 0.1);
        }

        .notification-badge {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 8px;
            height: 8px;
            background: var(--danger);
            border-radius: 50%;
        }

        /* Main Container */
        .container {
            max-width: 520px;
            margin: 0 auto;
            padding: 80px 20px 100px;
            position: relative;
            z-index: 1;
        }

        /* Cards */
        .card {
            background: rgba(10, 10, 26, 0.7);
            backdrop-filter: blur(25px);
            border-radius: 24px;
            border: 1px solid var(--glass-border);
            padding: 24px;
            margin-bottom: 24px;
            animation: fadeIn 0.6s ease-out;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
            border-color: rgba(123, 47, 247, 0.4);
        }

        .card::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: var(--gradient);
            border-radius: 26px;
            z-index: -1;
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .card:hover::before {
            opacity: 0.3;
        }

        /* Welcome Card */
        .welcome-card {
            background: linear-gradient(135deg, rgba(123, 47, 247, 0.25), rgba(0, 212, 255, 0.25));
            border: 1px solid rgba(123, 47, 247, 0.4);
        }

        .welcome-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .welcome-text h2 {
            font-size: 22px;
            font-weight: 800;
            margin-bottom: 8px;
            background: var(--gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .welcome-text p {
            color: var(--gray);
            font-size: 14px;
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(0, 255, 136, 0.15);
            color: var(--success);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 700;
            border: 1px solid rgba(0, 255, 136, 0.3);
        }

        .live-dot {
            width: 8px;
            height: 8px;
            background: var(--success);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        /* Wallet Summary */
        .wallet-summary {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 18px;
            margin-top: 20px;
        }

        .wallet-item {
            background: rgba(20, 20, 40, 0.6);
            border-radius: 18px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .wallet-item:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(123, 47, 247, 0.2);
        }

        .wallet-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .wallet-icon {
            width: 42px;
            height: 42px;
            background: rgba(123, 47, 247, 0.15);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-size: 18px;
        }

        .wallet-label {
            font-size: 13px;
            color: var(--gray);
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .wallet-value {
            font-size: 26px;
            font-weight: 900;
            color: var(--light);
            margin-top: 8px;
            text-shadow: 0 0 20px rgba(123, 47, 247, 0.3);
        }

        /* Plan Selection */
        .plan-selection {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-top: 20px;
        }

        .plan-card {
            background: rgba(20, 20, 40, 0.6);
            border-radius: 16px;
            padding: 18px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .plan-card:hover {
            transform: translateY(-5px);
            background: rgba(123, 47, 247, 0.1);
        }

        .plan-card.active {
            border-color: var(--primary);
            background: rgba(123, 47, 247, 0.15);
            animation: glow 3s infinite;
        }

        .plan-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--primary);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 700;
        }

        .plan-icon {
            width: 50px;
            height: 50px;
            background: var(--gradient);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 12px;
            color: white;
            font-size: 22px;
        }

        .plan-name {
            font-size: 16px;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .plan-price {
            font-size: 20px;
            font-weight: 900;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .plan-daily {
            font-size: 13px;
            color: var(--success);
            font-weight: 600;
        }

        .plan-duration {
            font-size: 12px;
            color: var(--gray);
            margin-top: 5px;
        }

        /* Mining Progress */
        .mining-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 800;
            color: var(--light);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title i {
            color: var(--primary);
        }

        .plan-status {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .current-plan {
            background: var(--gradient);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 700;
        }

        .mining-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 18px;
            margin-bottom: 25px;
        }

        .stat-item {
            background: rgba(20, 20, 40, 0.4);
            border-radius: 16px;
            padding: 18px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-label {
            font-size: 13px;
            color: var(--gray);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .stat-value {
            font-size: 20px;
            font-weight: 800;
            color: var(--light);
        }

        .progress-container {
            margin: 25px 0;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .progress-label {
            font-size: 14px;
            color: var(--gray);
            font-weight: 600;
        }

        .progress-percent {
            font-size: 14px;
            font-weight: 800;
            color: var(--primary);
        }

        .progress-bar {
            height: 10px;
            background: rgba(20, 20, 40, 0.6);
            border-radius: 5px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient);
            border-radius: 5px;
            width: 0%;
            transition: width 1.8s ease-out;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shine 2s infinite;
        }

        @keyframes shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .profit-container {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.15), rgba(123, 47, 247, 0.15));
            border: 1px solid rgba(0, 255, 136, 0.3);
            border-radius: 18px;
            padding: 20px;
            text-align: center;
            margin-top: 20px;
        }

        .profit-label {
            font-size: 14px;
            color: var(--gray);
            margin-bottom: 8px;
        }

        .profit-value {
            font-size: 36px;
            font-weight: 900;
            color: var(--success);
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
        }

        .countdown {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 13px;
            color: var(--gray);
            margin-top: 12px;
        }

        .countdown i {
            color: var(--primary);
        }

        /* Earnings Graph */
        .earnings-chart {
            margin-top: 20px;
            position: relative;
            height: 200px;
            background: rgba(20, 20, 40, 0.4);
            border-radius: 18px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 16px;
            font-weight: 700;
        }

        .chart-period {
            font-size: 13px;
            color: var(--gray);
        }

        .chart-container {
            width: 100%;
            height: 120px;
            position: relative;
        }

        .chart-line {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: rgba(255, 255, 255, 0.1);
        }

        .chart-bars {
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            height: 100%;
            padding: 0 10px;
        }

        .chart-bar {
            width: 25px;
            background: var(--gradient);
            border-radius: 6px 6px 0 0;
            transition: height 0.5s ease;
            position: relative;
        }

        .chart-bar:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(123, 47, 247, 0.4);
        }

        .chart-bar-value {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 11px;
            color: var(--gray);
            font-weight: 600;
        }

        .chart-labels {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
        }

        .chart-label {
            font-size: 12px;
            color: var(--gray);
        }

        /* Real-time Stats */
        .real-time-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .stat-card {
            background: rgba(20, 20, 40, 0.6);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            background: rgba(123, 47, 247, 0.15);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 12px;
            color: var(--primary);
            font-size: 18px;
        }

        .stat-value-large {
            font-size: 24px;
            font-weight: 900;
            color: var(--light);
            margin-bottom: 5px;
        }

        .stat-label-small {
            font-size: 12px;
            color: var(--gray);
            font-weight: 600;
        }

        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .action-btn {
            background: rgba(20, 20, 40, 0.6);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
        }

        .action-btn:hover {
            background: rgba(123, 47, 247, 0.15);
            border-color: var(--primary);
            transform: translateY(-5px);
        }

        .action-icon {
            width: 48px;
            height: 48px;
            background: var(--gradient);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
        }

        .action-label {
            font-size: 14px;
            font-weight: 700;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: none;
            justify-content: center;
            align-items: center;
            padding: 20px;
            animation: fadeIn 0.4s ease-out;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: rgba(10, 10, 26, 0.95);
            backdrop-filter: blur(25px);
            border-radius: 24px;
            border: 1px solid var(--glass-border);
            padding: 30px;
            width: 100%;
            max-width: 450px;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideIn 0.4s ease-out;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .modal-title {
            font-size: 22px;
            font-weight: 800;
            background: var(--gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .modal-close {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: var(--gray);
            font-size: 24px;
            cursor: pointer;
            padding: 8px;
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
            color: var(--light);
        }

        .modal-body {
            margin-bottom: 25px;
        }

        .plan-details {
            background: rgba(20, 20, 40, 0.6);
            border-radius: 18px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--glass-border);
        }

        .plan-details-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .plan-details-row:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .plan-details-label {
            color: var(--gray);
            font-size: 14px;
        }

        .plan-details-value {
            color: var(--light);
            font-weight: 700;
            font-size: 14px;
        }

        .plan-details-value.highlight {
            color: var(--primary);
        }

        .plan-details-value.success {
            color: var(--success);
        }

        .plan-description {
            font-size: 14px;
            color: var(--gray);
            line-height: 1.6;
            margin-top: 20px;
        }

        .modal-footer {
            display: flex;
            gap: 15px;
        }

        .btn {
            padding: 16px 24px;
            border-radius: 16px;
            font-weight: 700;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            flex: 1;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: var(--gradient);
            color: white;
            box-shadow: 0 8px 25px rgba(123, 47, 247, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(123, 47, 247, 0.5);
        }

        .btn-secondary {
            background: rgba(20, 20, 40, 0.8);
            color: var(--light);
            border: 1px solid var(--glass-border);
        }

        .btn-secondary:hover {
            background: rgba(20, 20, 40, 1);
            border-color: var(--primary);
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            display: none;
        }

        .loading .btn-text {
            display: none;
        }

        .loading .spinner {
            display: block;
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(10, 10, 26, 0.98);
            backdrop-filter: blur(25px);
            border-top: 1px solid var(--glass-border);
            padding: 15px 20px;
            display: flex;
            justify-content: space-around;
            z-index: 100;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            padding: 12px;
            border-radius: 16px;
            transition: all 0.3s ease;
            flex: 1;
            max-width: 100px;
        }

        .nav-item.active {
            background: rgba(123, 47, 247, 0.2);
            color: var(--primary);
            border: 1px solid rgba(123, 47, 247, 0.4);
            transform: translateY(-5px);
        }

        .nav-item:hover {
            color: var(--primary);
            transform: translateY(-3px);
        }

        .nav-icon {
            font-size: 22px;
        }

        .nav-label {
            font-size: 13px;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        /* Loading States */
        .loading-skeleton {
            background: linear-gradient(90deg, 
                rgba(255,255,255,0.05) 25%, 
                rgba(255,255,255,0.1) 50%, 
                rgba(255,255,255,0.05) 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 8px;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Real-time Indicator */
        .real-time-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: var(--success);
            font-weight: 600;
            margin-left: 10px;
        }

        .real-time-dot {
            width: 8px;
            height: 8px;
            background: var(--success);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        /* Responsive */
        @media (min-width: 768px) {
            .container {
                padding: 100px 20px 120px;
            }
            
            .top-nav {
                padding: 20px 40px;
            }
            
            .bottom-nav {
                padding: 15px 40px;
            }
        }
    </style>
</head>
<body>
    <div class="bg-blob blob-1"></div>
    <div class="bg-blob blob-2"></div>

    <div class="toast-container" id="toastContainer"></div>

    <!-- Top Navigation -->
    <nav class="top-nav">
        <div class="logo">INVITEGAIN</div>
        <div class="page-title">Dashboard</div>
        <div class="nav-icons">
            <button class="nav-icon" onclick="showNotifications()">
                <i class="fas fa-bell"></i>
                <span class="notification-badge" id="notificationBadge" style="display: none;"></span>
            </button>
            <button class="nav-icon" onclick="navigateTo('profile.html')">
                <i class="fas fa-user"></i>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <!-- Welcome Card -->
        <div class="card welcome-card fade-in" id="welcomeCard">
            <div class="welcome-header">
                <div class="welcome-text">
                    <h2 id="userName">Loading...</h2>
                    <p id="userInfo">@username</p>
                </div>
                <span class="status-badge" id="userStatus">
                    <span class="live-dot"></span>
                    <span>Active</span>
                </span>
            </div>
            <p style="font-size: 14px; color: var(--gray); margin-top: 12px;" id="welcomeMessage">
                Your mining operation is running in real-time...
            </p>
        </div>

        <!-- Wallet Summary -->
        <div class="card fade-in">
            <div class="section-title">
                <i class="fas fa-wallet"></i>
                Wallet Summary
            </div>
            <div class="wallet-summary" id="walletSummary">
                <!-- Wallet items will be populated by JavaScript -->
            </div>
        </div>

        <!-- Plan Selection -->
        <div class="card fade-in">
            <div class="section-title">
                <i class="fas fa-crown"></i>
                Select Mining Plan
            </div>
            <div class="plan-selection" id="planSelection">
                <!-- Plan cards will be populated by JavaScript -->
            </div>
        </div>

        <!-- Mining Progress -->
        <div class="card fade-in" id="miningCard">
            <div class="mining-header">
                <div class="section-title">
                    <i class="fas fa-digging"></i>
                    Mining Progress
                </div>
                <div class="plan-status">
                    <div class="current-plan" id="currentPlanBadge">No Active Plan</div>
                </div>
            </div>
            
            <div class="mining-stats" id="miningStats">
                <!-- Mining stats will be populated by JavaScript -->
            </div>
            
            <div class="progress-container">
                <div class="progress-header">
                    <div class="progress-label">Mining Completion</div>
                    <div class="progress-percent" id="progressPercent">0%</div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>
            
            <div class="profit-container">
                <div class="profit-label">Today's Mining Profit</div>
                <div class="profit-value" id="todayProfit">0 PKR</div>
                <div class="countdown">
                    <i class="fas fa-clock"></i>
                    Next profit in: <span id="countdownTimer">00:00:00</span>
                    <span class="real-time-indicator">
                        <span class="real-time-dot"></span>
                        LIVE
                    </span>
                </div>
            </div>
        </div>

        <!-- Earnings Graph -->
        <div class="card fade-in">
            <div class="chart-header">
                <div class="chart-title">Daily Earnings Trend</div>
                <div class="chart-period">Last 7 Days</div>
            </div>
            <div class="earnings-chart">
                <div class="chart-container" id="earningsChart">
                    <!-- Chart will be drawn by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Real-time Stats -->
        <div class="card fade-in">
            <div class="section-title">
                <i class="fas fa-chart-line"></i>
                Real-time Statistics
            </div>
            <div class="real-time-stats" id="realTimeStats">
                <!-- Stats will be populated by JavaScript -->
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="card fade-in">
            <div class="section-title">
                <i class="fas fa-bolt"></i>
                Quick Actions
            </div>
            <div class="quick-actions">
                <div class="action-btn" onclick="openModal('planModal')">
                    <div class="action-icon">
                        <i class="fas fa-crown"></i>
                    </div>
                    <div class="action-label">Change Plan</div>
                </div>
                <div class="action-btn" onclick="navigateTo('referral.html')">
                    <div class="action-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="action-label">Referral</div>
                </div>
                <div class="action-btn" onclick="shareDashboard()">
                    <div class="action-icon">
                        <i class="fas fa-share-alt"></i>
                    </div>
                    <div class="action-label">Share</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <button class="nav-item active">
            <i class="fas fa-chart-line nav-icon"></i>
            <span class="nav-label">Dashboard</span>
        </button>
        <button class="nav-item" onclick="navigateTo('investment.html')">
            <i class="fas fa-coins nav-icon"></i>
            <span class="nav-label">Investment</span>
        </button>
        <button class="nav-item" onclick="navigateTo('referral.html')">
            <i class="fas fa-gift nav-icon"></i>
            <span class="nav-label">Referral</span>
        </button>
        <button class="nav-item" onclick="navigateTo('profile.html')">
            <i class="fas fa-user nav-icon"></i>
            <span class="nav-label">Profile</span>
        </button>
    </nav>

    <!-- Plan Details Modal -->
    <div class="modal-overlay" id="planModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">Plan Details</div>
                <button class="modal-close" onclick="closeModal('planModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="plan-details" id="planDetails">
                    <!-- Plan details will be populated by JavaScript -->
                </div>
                <div class="plan-description" id="planDescription">
                    <!-- Plan description will be populated by JavaScript -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('planModal')">
                    Cancel
                </button>
                <button class="btn btn-primary" id="activatePlanBtn" onclick="activatePlan()">
                    <span class="btn-text">Activate Plan</span>
                    <div class="spinner"></div>
                </button>
            </div>
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAYDVkQygUuLtS8ZIRJF6m1s3t-_hF89DY",
            authDomain: "invitegain-6ce0d.firebaseapp.com",
            projectId: "invitegain-6ce0d",
            storageBucket: "invitegain-6ce0d.firebasestorage.app",
            messagingSenderId: "586313606242",
            appId: "1:586313606242:web:ae8da69bb8003bdd799d3b",
            measurementId: "G-T4RBRVEN1F"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // State Variables
        let currentUser = null;
        let selectedPlan = null;
        let activeInvestment = null;
        let unsubscribeUser = null;
        let unsubscribeInvestment = null;
        let countdownInterval = null;
        let earningsData = [];

        // Available Plans
        const miningPlans = [
            {
                id: 'starter',
                name: 'Starter Plan',
                icon: 'fas fa-seedling',
                price: 3000,
                dailyProfit: 50,
                duration: 30,
                color: '#00d4ff',
                description: 'Perfect for beginners. Start earning daily profits with minimal investment.',
                features: [
                    'Daily Profit: 50 PKR',
                    'Duration: 30 Days',
                    'Total Return: 1500 PKR',
                    'Withdraw Anytime'
                ]
            },
            {
                id: 'silver',
                name: 'Silver Plan',
                icon: 'fas fa-medal',
                price: 8000,
                dailyProfit: 128,
                duration: 25,
                color: '#b0b0d0',
                description: 'Most popular choice. Balanced returns with moderate investment.',
                features: [
                    'Daily Profit: 128 PKR',
                    'Duration: 25 Days',
                    'Total Return: 3200 PKR',
                    'Priority Support'
                ]
            },
            {
                id: 'gold',
                name: 'Gold Plan',
                icon: 'fas fa-crown',
                price: 15000,
                dailyProfit: 250,
                duration: 24,
                color: '#ffaa00',
                description: 'Premium plan for serious investors. Maximum daily returns.',
                features: [
                    'Daily Profit: 250 PKR',
                    'Duration: 24 Days',
                    'Total Return: 6000 PKR',
                    'VIP Support',
                    'Bonus: 5% Extra'
                ]
            },
            {
                id: 'platinum',
                name: 'Platinum Plan',
                icon: 'fas fa-gem',
                price: 30000,
                dailyProfit: 550,
                duration: 20,
                color: '#7b2ff7',
                description: 'Elite plan for maximum returns. Special VIP benefits included.',
                features: [
                    'Daily Profit: 550 PKR',
                    'Duration: 20 Days',
                    'Total Return: 11000 PKR',
                    '24/7 VIP Support',
                    'Bonus: 10% Extra',
                    'Early Access Features'
                ]
            },
            {
                id: 'diamond',
                name: 'Diamond Plan',
                icon: 'fas fa-diamond',
                price: 50000,
                dailyProfit: 1000,
                duration: 18,
                color: '#00ff88',
                description: 'Ultimate investment plan. Highest returns with special rewards.',
                features: [
                    'Daily Profit: 1000 PKR',
                    'Duration: 18 Days',
                    'Total Return: 18000 PKR',
                    'Personal Account Manager',
                    'Bonus: 15% Extra',
                    'Exclusive Rewards'
                ]
            }
        ];

        // Initialize Dashboard
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthState();
            setupNavigation();
            
            // Add animation delay for cards
            document.querySelectorAll('.fade-in').forEach((card, index) => {
                card.style.animationDelay = `${index * 0.1}s`;
            });
        });

     

        // Load User Data
        async function loadUserData(userId) {
            try {
                const userDoc = await db.collection('users').doc(userId).get();
                if (userDoc.exists) {
                    const userData = userDoc.data();
                    updateUserUI(userData);
                }
            } catch (error) {
                console.error('Error loading user data:', error);
                showToast('error', 'Error', 'Failed to load user data');
            }
        }

        // Setup Realtime Listeners
        function setupRealtimeListeners(userId) {
            // Listen for user data changes
            unsubscribeUser = db.collection('users').doc(userId)
                .onSnapshot((doc) => {
                    if (doc.exists) {
                        const userData = doc.data();
                        updateUserUI(userData);
                    }
                }, (error) => {
                    console.error('Error listening to user data:', error);
                });

            // Listen for active investment
            unsubscribeInvestment = db.collection('investments')
                .where('userId', '==', userId)
                .where('status', '==', 'active')
                .limit(1)
                .onSnapshot((snapshot) => {
                    if (!snapshot.empty) {
                        const investment = snapshot.docs[0].data();
                        investment.id = snapshot.docs[0].id;
                        activeInvestment = investment;
                        updateMiningUI(investment);
                        startCountdown(investment);
                    } else {
                        activeInvestment = null;
                        showNoActivePlan();
                    }
                }, (error) => {
                    console.error('Error listening to investment:', error);
                });

            // Listen for earnings data
            db.collection('earnings')
                .where('userId', '==', userId)
                .orderBy('date', 'desc')
                .limit(7)
                .onSnapshot((snapshot) => {
                    earningsData = [];
                    snapshot.forEach((doc) => {
                        earningsData.push(doc.data());
                    });
                    earningsData.reverse(); // Oldest to newest
                    updateChart();
                });
        }

        // Initialize UI
        function initUI() {
            // Render plan selection
            renderPlanSelection();
            
            // Render wallet summary
            renderWalletSummary();
            
            // Render real-time stats
            renderRealTimeStats();
        }

        // Update User UI
        function updateUserUI(userData) {
            document.getElementById('userName').textContent = `Welcome, ${userData.name || 'User'} ðŸ‘‹`;
            document.getElementById('userInfo').textContent = `@${userData.username || 'user'}`;
            document.getElementById('welcomeMessage').textContent = 
                userData.hasInvestment ? 
                'Your mining operation is running in real-time...' :
                'Select a mining plan to start earning daily profits!';
        }

        // Render Plan Selection
        function renderPlanSelection() {
            const container = document.getElementById('planSelection');
            container.innerHTML = '';

            miningPlans.forEach(plan => {
                const isActive = activeInvestment && activeInvestment.planId === plan.id;
                
                const planHTML = `
                    <div class="plan-card ${isActive ? 'active' : ''}" 
                         data-plan-id="${plan.id}"
                         onclick="selectPlan('${plan.id}')">
                        ${isActive ? '<div class="plan-badge">ACTIVE</div>' : ''}
                        <div class="plan-icon" style="background: ${plan.color}">
                            <i class="${plan.icon}"></i>
                        </div>
                        <div class="plan-name">${plan.name}</div>
                        <div class="plan-price">${plan.price.toLocaleString()} PKR</div>
                        <div class="plan-daily">${plan.dailyProfit.toLocaleString()} PKR/day</div>
                        <div class="plan-duration">${plan.duration} days</div>
                    </div>
                `;
                
                container.innerHTML += planHTML;
            });
        }

        // Select Plan
        function selectPlan(planId) {
            selectedPlan = miningPlans.find(plan => plan.id === planId);
            if (!selectedPlan) return;

            // Update plan details modal
            const detailsHTML = `
                <div class="plan-details-row">
                    <span class="plan-details-label">Plan Name</span>
                    <span class="plan-details-value highlight">${selectedPlan.name}</span>
                </div>
                <div class="plan-details-row">
                    <span class="plan-details-label">Investment Amount</span>
                    <span class="plan-details-value">${selectedPlan.price.toLocaleString()} PKR</span>
                </div>
                <div class="plan-details-row">
                    <span class="plan-details-label">Daily Profit</span>
                    <span class="plan-details-value success">${selectedPlan.dailyProfit.toLocaleString()} PKR</span>
                </div>
                <div class="plan-details-row">
                    <span class="plan-details-label">Plan Duration</span>
                    <span class="plan-details-value">${selectedPlan.duration} days</span>
                </div>
                <div class="plan-details-row">
                    <span class="plan-details-label">Total Return</span>
                    <span class="plan-details-value success">${(selectedPlan.dailyProfit * selectedPlan.duration).toLocaleString()} PKR</span>
                </div>
            `;

            const descriptionHTML = `
                <strong>Features:</strong><br>
                ${selectedPlan.features.map(feature => `â€¢ ${feature}`).join('<br>')}<br><br>
                ${selectedPlan.description}
            `;

            document.getElementById('planDetails').innerHTML = detailsHTML;
            document.getElementById('planDescription').innerHTML = descriptionHTML;

            // Show modal
            openModal('planModal');
        }

        // Activate Plan
        async function activatePlan() {
            if (!selectedPlan || !currentUser) {
                showToast('error', 'Error', 'No plan selected');
                return;
            }

            const userId = currentUser.uid;
            const button = document.getElementById('activatePlanBtn');
            
            setLoading(button, true);

            try {
                // Check if user has active investment
                if (activeInvestment) {
                    showToast('error', 'Active Plan', 'You already have an active mining plan');
                    setLoading(button, false);
                    return;
                }

                // Check wallet balance (simulated)
                const userDoc = await db.collection('users').doc(userId).get();
                const userData = userDoc.data();
                const walletBalance = userData.walletBalance || 0;

                if (walletBalance < selectedPlan.price) {
                    showToast('error', 'Insufficient Balance', `You need ${selectedPlan.price - walletBalance} PKR more`);
                    setLoading(button, false);
                    return;
                }

                // Create investment record
                const investmentData = {
                    userId: userId,
                    planId: selectedPlan.id,
                    planName: selectedPlan.name,
                    amount: selectedPlan.price,
                    dailyProfit: selectedPlan.dailyProfit,
                    totalDays: selectedPlan.duration,
                    completedDays: 0,
                    remainingDays: selectedPlan.duration,
                    totalProfit: 0,
                    startDate: new Date(),
                    lastProfitDate: new Date(),
                    nextProfitDate: new Date(Date.now() + 24 * 60 * 60 * 1000), // 24 hours from now
                    status: 'active',
                    createdAt: new Date()
                };

                // Update wallet balance
                const newBalance = walletBalance - selectedPlan.price;
                await db.collection('users').doc(userId).update({
                    walletBalance: newBalance,
                    hasInvestment: true,
                    lastInvestmentDate: new Date()
                });

                // Save investment
                await db.collection('investments').add(investmentData);

                // Create first earning record
                const earningData = {
                    userId: userId,
                    amount: selectedPlan.dailyProfit,
                    date: new Date(),
                    type: 'mining',
                    planId: selectedPlan.id,
                    status: 'completed'
                };

                await db.collection('earnings').add(earningData);

                showToast('success', 'Plan Activated!', `${selectedPlan.name} is now active. Mining started!`);
                closeModal('planModal');
                
                // Update UI
                updateWalletBalance(newBalance);

            } catch (error) {
                console.error('Error activating plan:', error);
                showToast('error', 'Error', 'Failed to activate plan. Please try again.');
            } finally {
                setLoading(button, false);
            }
        }

        // Update Mining UI
        function updateMiningUI(investment) {
            const plan = miningPlans.find(p => p.id === investment.planId);
            if (!plan) return;

            // Update current plan badge
            document.getElementById('currentPlanBadge').textContent = plan.name;
            
            // Update mining stats
            const completedDays = investment.completedDays || 0;
            const totalDays = investment.totalDays || plan.duration;
            const progressPercent = Math.round((completedDays / totalDays) * 100);
            const remainingDays = totalDays - completedDays;
            const totalProfit = investment.totalProfit || 0;

            const statsHTML = `
                <div class="stat-item">
                    <div class="stat-label">
                        <i class="fas fa-calendar-check"></i>
                        Completed Days
                    </div>
                    <div class="stat-value">${completedDays}</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">
                        <i class="fas fa-calendar-times"></i>
                        Remaining Days
                    </div>
                    <div class="stat-value">${remainingDays}</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">
                        <i class="fas fa-coins"></i>
                        Daily Profit
                    </div>
                    <div class="stat-value">${plan.dailyProfit.toLocaleString()} PKR</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">
                        <i class="fas fa-chart-line"></i>
                        Total Profit
                    </div>
                    <div class="stat-value">${totalProfit.toLocaleString()} PKR</div>
                </div>
            `;

            document.getElementById('miningStats').innerHTML = statsHTML;
            document.getElementById('progressPercent').textContent = `${progressPercent}%`;
            document.getElementById('progressFill').style.width = `${progressPercent}%`;
            document.getElementById('todayProfit').textContent = `${plan.dailyProfit.toLocaleString()} PKR`;

            // Update plan selection to show active plan
            renderPlanSelection();
        }

        // Show No Active Plan
        function showNoActivePlan() {
            document.getElementById('currentPlanBadge').textContent = 'No Active Plan';
            document.getElementById('miningStats').innerHTML = `
                <div class="stat-item" style="grid-column: 1 / -1; text-align: center; padding: 30px;">
                    <div class="stat-label">
                        <i class="fas fa-exclamation-circle"></i>
                        No Active Mining Plan
                    </div>
                    <div class="stat-value" style="font-size: 16px; color: var(--gray); margin-top: 10px;">
                        Select a plan to start mining
                    </div>
                </div>
            `;
            document.getElementById('progressPercent').textContent = '0%';
            document.getElementById('progressFill').style.width = '0%';
            document.getElementById('todayProfit').textContent = '0 PKR';
            document.getElementById('countdownTimer').textContent = '--:--:--';

            if (countdownInterval) {
                clearInterval(countdownInterval);
                countdownInterval = null;
            }
        }

        // Start Countdown Timer
        function startCountdown(investment) {
            if (countdownInterval) {
                clearInterval(countdownInterval);
            }

            function updateTimer() {
                if (!investment || !investment.nextProfitDate) return;

                const nextProfitTime = investment.nextProfitDate.toDate
                    ? investment.nextProfitDate.toDate().getTime()
                    : new Date(investment.nextProfitDate).getTime();

                const now = new Date().getTime();
                const timeLeft = nextProfitTime - now;

                if (timeLeft <= 0) {
                    // Time to add profit
                    addDailyProfit(investment);
                    return;
                }

                const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);

                document.getElementById('countdownTimer').textContent = 
                    `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }

            updateTimer();
            countdownInterval = setInterval(updateTimer, 1000);
        }

        // Add Daily Profit
        async function addDailyProfit(investment) {
            if (!currentUser || !investment) return;

            const userId = currentUser.uid;
            const plan = miningPlans.find(p => p.id === investment.planId);
            if (!plan) return;

            try {
                // Update investment record
                const completedDays = (investment.completedDays || 0) + 1;
                const totalProfit = (investment.totalProfit || 0) + plan.dailyProfit;
                const remainingDays = plan.duration - completedDays;

                await db.collection('investments').doc(investment.id).update({
                    completedDays: completedDays,
                    remainingDays: remainingDays,
                    totalProfit: totalProfit,
                    lastProfitDate: new Date(),
                    nextProfitDate: new Date(Date.now() + 24 * 60 * 60 * 1000)
                });

                // Update user wallet
                const userDoc = await db.collection('users').doc(userId).get();
                const userData = userDoc.data();
                const newBalance = (userData.walletBalance || 0) + plan.dailyProfit;

                await db.collection('users').doc(userId).update({
                    walletBalance: newBalance,
                    totalEarnings: (userData.totalEarnings || 0) + plan.dailyProfit
                });

                // Add earning record
                const earningData = {
                    userId: userId,
                    amount: plan.dailyProfit,
                    date: new Date(),
                    type: 'mining',
                    planId: plan.id,
                    status: 'completed'
                };

                await db.collection('earnings').add(earningData);

                // Update UI
                updateWalletBalance(newBalance);
                
                // Show notification
                showToast('success', 'Daily Profit Added!', `${plan.dailyProfit.toLocaleString()} PKR added to your wallet`);

            } catch (error) {
                console.error('Error adding daily profit:', error);
            }
        }

        // Render Wallet Summary
        function renderWalletSummary() {
            const container = document.getElementById('walletSummary');
            container.innerHTML = `
                <div class="wallet-item">
                    <div class="wallet-header">
                        <div class="wallet-icon">
                            <i class="fas fa-wallet"></i>
                        </div>
                        <div class="wallet-label">Wallet Balance</div>
                    </div>
                    <div class="wallet-value" id="walletBalance">0 PKR</div>
                </div>
                <div class="wallet-item">
                    <div class="wallet-header">
                        <div class="wallet-icon">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <div class="wallet-label">Total Earnings</div>
                    </div>
                    <div class="wallet-value" id="totalEarnings">0 PKR</div>
                </div>
                <div class="wallet-item">
                    <div class="wallet-header">
                        <div class="wallet-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="wallet-label">Active Days</div>
                    </div>
                    <div class="wallet-value" id="activeDays">0</div>
                </div>
                <div class="wallet-item">
                    <div class="wallet-header">
                        <div class="wallet-icon">
                            <i class="fas fa-gem"></i>
                        </div>
                        <div class="wallet-label">Current Plan</div>
                    </div>
                    <div class="wallet-value" id="currentPlanValue">None</div>
                </div>
            `;
        }

        // Update Wallet Balance
        async function updateWalletBalance(balance) {
            document.getElementById('walletBalance').textContent = `${balance.toLocaleString()} PKR`;
            
            // Also update user data
            if (currentUser) {
                const userDoc = await db.collection('users').doc(currentUser.uid).get();
                if (userDoc.exists) {
                    const userData = userDoc.data();
                    document.getElementById('totalEarnings').textContent = `${(userData.totalEarnings || 0).toLocaleString()} PKR`;
                    document.getElementById('activeDays').textContent = userData.activeDays || '0';
                    
                    if (activeInvestment) {
                        const plan = miningPlans.find(p => p.id === activeInvestment.planId);
                        document.getElementById('currentPlanValue').textContent = plan ? plan.name : 'Active';
                    }
                }
            }
        }

        // Render Real-time Stats
        function renderRealTimeStats() {
            const container = document.getElementById('realTimeStats');
            container.innerHTML = `
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <div class="stat-value-large" id="todayEarnings">0 PKR</div>
                    <div class="stat-label-small">Today's Earnings</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-calendar-week"></i>
                    </div>
                    <div class="stat-value-large" id="weekEarnings">0 PKR</div>
                    <div class="stat-label-small">This Week</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                    <div class="stat-value-large" id="monthEarnings">0 PKR</div>
                    <div class="stat-label-small">This Month</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-chart-bar"></i>
                    </div>
                    <div class="stat-value-large" id="allTimeEarnings">0 PKR</div>
                    <div class="stat-label-small">All Time</div>
                </div>
            `;
        }

        // Render Chart
        function renderChart() {
            const container = document.getElementById('earningsChart');
            container.innerHTML = `
                <div class="chart-line"></div>
                <div class="chart-bars" id="chartBars"></div>
                <div class="chart-labels">
                    ${['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'].map(day => 
                        `<div class="chart-label">${day}</div>`
                    ).join('')}
                </div>
            `;
        }

        // Update Chart
        function updateChart() {
            const barsContainer = document.getElementById('chartBars');
            if (!barsContainer) return;

            // Generate sample data if no real data
            const data = earningsData.length > 0 ? 
                earningsData.map(e => e.amount) : 
                Array(7).fill(0).map(() => Math.floor(Math.random() * 500) + 100);

            const maxValue = Math.max(...data, 500); // Minimum max of 500
            const barHeight = 120; // Container height

            barsContainer.innerHTML = data.map(amount => {
                const height = (amount / maxValue) * barHeight;
                return `
                    <div class="chart-bar" style="height: ${height}px">
                        <div class="chart-bar-value">${amount}</div>
                    </div>
                `;
            }).join('');
        }

        // Toast System
        function showToast(type, title, message) {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            const icon = type === 'success' ? 'fa-check-circle' : 
                         type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle';
            
            toast.innerHTML = `
                <i class="fas ${icon}"></i>
                <div class="toast-content">
                    <div class="toast-title">${title}</div>
                    <div class="toast-message">${message}</div>
                </div>
                <button class="toast-close" onclick="this.parentElement.remove()">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            container.appendChild(toast);
            
            setTimeout(() => {
                if (toast.parentElement) {
                    toast.remove();
                }
            }, 5000);
        }

        // Modal Functions
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // Set Loading State
        function setLoading(button, isLoading) {
            if (button) {
                if (isLoading) {
                    button.classList.add('loading');
                    button.disabled = true;
                } else {
                    button.classList.remove('loading');
                    button.disabled = false;
                }
            }
        }

        // Navigation
        function navigateTo(page) {
            window.location.href = page;
        }

        function setupNavigation() {
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                if (item.classList.contains('active')) {
                    item.classList.remove('active');
                }
            });
            document.querySelector('.nav-item:nth-child(1)').classList.add('active');
        }

        // Share Dashboard
        function shareDashboard() {
            const shareData = {
                title: 'My INVITEGAIN Dashboard',
                text: 'Check out my mining earnings on INVITEGAIN!',
                url: window.location.href
            };

            if (navigator.share) {
                navigator.share(shareData);
            } else {
                navigator.clipboard.writeText(shareData.url)
                    .then(() => showToast('success', 'Copied!', 'Dashboard link copied to clipboard'))
                    .catch(() => showToast('error', 'Error', 'Failed to copy link'));
            }
        }

        // Show Notifications
        function showNotifications() {
            showToast('info', 'Notifications', 'You have no new notifications');
        }

        // Clean up on page unload
        window.addEventListener('beforeunload', () => {
            if (unsubscribeUser) unsubscribeUser();
            if (unsubscribeInvestment) unsubscribeInvestment();
            if (countdownInterval) clearInterval(countdownInterval);
        });

        // Handle page visibility change
        document.addEventListener('visibilitychange', () => {
            if (!document.hidden && activeInvestment) {
                startCountdown(activeInvestment);
            }
        });
    </script>
</body>
</html>